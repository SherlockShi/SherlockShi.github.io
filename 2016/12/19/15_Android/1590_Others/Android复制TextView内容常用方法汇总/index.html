<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        Android复制TextView内容常用方法汇总 | SherlockShi&#39;s Home
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="SherlockShi">
    <meta name="description" content="Don&#39;t be evil.">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="SherlockShi&#39;s Home">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://sherlockshi.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Android复制TextView内容常用方法汇总 | SherlockShi&#39;s Home">
    <meta property="og:description" content="Don&#39;t be evil.">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
        
			<!-- GoogleAnalytics -->
			<script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-85064715-1', 'auto'); ga('send', 'pageview');
</script>
        
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一、前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#二、需求分析"><span class="post-toc-number">2.</span> <span class="post-toc-text">二、需求分析</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#三、功能实现"><span class="post-toc-number">3.</span> <span class="post-toc-text">三、功能实现</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#四、掉坑了"><span class="post-toc-number">4.</span> <span class="post-toc-text">四、掉坑了</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#五、解决"><span class="post-toc-number">5.</span> <span class="post-toc-text">五、解决</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-LongClick事件-PopupWindow"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">1. LongClick事件 + PopupWindow</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-LongClick事件-ContextMenu"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">2. LongClick事件 + ContextMenu</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-Click事件-ClipboardManager"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">3. Click事件 + ClipboardManager</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-RecyclerView-textIsSelectable"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">4. RecyclerView + textIsSelectable</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-额外赠送：SelectableTextHelper"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">5. 额外赠送：SelectableTextHelper</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#六、总结"><span class="post-toc-number">6.</span> <span class="post-toc-text">六、总结</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#七、疑问"><span class="post-toc-number">7.</span> <span class="post-toc-text">七、疑问</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#附录"><span class="post-toc-number">8.</span> <span class="post-toc-text">附录</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-当textIsSelectable为false时"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">1. 当textIsSelectable为false时</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-1-未设置TextView的点击、长按事件："><span class="post-toc-number">8.1.1.</span> <span class="post-toc-text">1.1 未设置TextView的点击、长按事件：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-有设置TextView的点击、长按事件："><span class="post-toc-number">8.1.2.</span> <span class="post-toc-text">1.2 有设置TextView的点击、长按事件：</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-当textIsSelectable为true时"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">2. 当textIsSelectable为true时</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-未设置TextView的点击、长按事件："><span class="post-toc-number">8.2.1.</span> <span class="post-toc-text">2.1 未设置TextView的点击、长按事件：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-2-有设置TextView的点击、长按事件："><span class="post-toc-number">8.2.2.</span> <span class="post-toc-text">2.2 有设置TextView的点击、长按事件：</span></a></li></ol></li></ol></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 7 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            Android复制TextView内容常用方法汇总
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>SherlockShi</strong>
        <span>12月 19, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Android/">Android</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/TextView/">TextView</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/复制/">复制</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/" class="leancloud-views_num" data-flag-title="Android复制TextView内容常用方法汇总">
     &nbsp;浏览量
</span>
        </li>
    </a>
    
    
    
    <!-- Busuanzi Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="busuanzi_container_page_pv">
                <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
            </span>
        </li>
    </a>
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Android复制TextView内容常用方法汇总&url=http://sherlockshi.github.io//2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/index.html&via=SherlockShi" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://sherlockshi.github.io//2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Android复制TextView内容常用方法汇总&url=http://sherlockshi.github.io//2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>最近在项目中，需要提供TextView的复制功能，让用户可以自由复制App中某些界面的特定内容。</p>
<p>需求来源于用户有时需要复制编号，用于其它地方的搜索，比如下图中TD开头的这一长串编号。</p>
<p>如果在搜索时，需要手输这一长串字符，先不说记住这一串数据需要怎样的记忆力，就说输入这一长串字符的时间，对于用户来说就是不可接受的。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-12-131832.jpg" alt=""></p>
<h1 id="二、需求分析"><a href="#二、需求分析" class="headerlink" title="二、需求分析"></a>二、需求分析</h1><p>这时候，我们很自然地就会想到，我们经常使用的复制功能，是类似这样的：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-12-UOAIROGQ7SO7PBCU.jpg" alt=""></p>
<p>长按某一段文字后，在文字上方或标题栏处会出现<code>全选</code>、<code>复制</code>等功能按钮，点击后就能复制，然后在你需要输入的地方长按，就会出现<code>粘贴</code>按钮，点击后就能成功粘贴。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-12-133532.jpg" alt=""></p>
<h1 id="三、功能实现"><a href="#三、功能实现" class="headerlink" title="三、功能实现"></a>三、功能实现</h1><p>查看<a href="https://developer.android.com/reference/android/widget/TextView.html" target="_blank" rel="external">TextView的API</a>，里面就有这么一段介绍：</p>
<blockquote>
<p>To allow users to copy some or all of the TextView’s value and paste it somewhere else, set the XML attribute <code>android:textIsSelectable</code> to “<code>true</code>“ or call <code>setTextIsSelectable(true)</code>. The textIsSelectable flag allows users to make selection gestures in the TextView, which in turn triggers the system’s built-in copy/paste controls.</p>
</blockquote>
<p>意思就是使用<code>textIsSelectable</code>属性就可以触发系统内置的复制/粘贴功能。</p>
<p>那么最简单的方法就是直接在XML文件中，给TextView设置<code>textIsSelectable</code>属性为<code>true</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">    <span class="attr">android:text</span>=<span class="string">"TD201612120166"</span></span><br><span class="line">    <span class="attr">android:textIsSelectable</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>当然，也可以使用java代码实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tv.setTextIsSelectable(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-12-141141.jpg" alt=""></p>
<p>效果也确实立杆见影，一步完成。</p>
<p>好嗨森，可以收工啦，赶紧把项目中另一个地方也改掉，就可以提交代码啦～</p>
<h1 id="四、掉坑了"><a href="#四、掉坑了" class="headerlink" title="四、掉坑了"></a>四、掉坑了</h1><p>由于本项目为老项目，列表使用的是ListView（SDK使用的是19），而另一个需要修改的地方，就是ListView列表里面的子项TextView。</p>
<p>当为其设置<code>textIsSelectable</code>属性后，长按这一长串数字编号，这时候数字是选中了，但是并没有弹出<code>复制</code>的选项啊，而且更重要的是，<strong>ListView的Item点击事件没有了啊啊啊～～～</strong></p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-18-031427.jpg" alt=""></p>
<blockquote>
<p>注：在某些SDK版本上，长按TextView后，会在ToolBar(ActionBar)位置弹出<code>全选</code>、<code>复制</code>等功能按钮（如下图），而当设置<code>textIsSelectable</code>属性后，该功能条会下滑出现，而在一瞬间又上滑消失，实际看到的效果就是ToolBar处会有内容闪现并瞬间消失，但是看不清具体内容。</p>
</blockquote>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-18-7N2SSE154S007872.jpg" alt=""></p>
<h1 id="五、解决"><a href="#五、解决" class="headerlink" title="五、解决"></a>五、解决</h1><p>网上搜索一番，果然也有不少解决方案，但有一些亲测无效，就不列出了，以下是亲测可用的解决方案。</p>
<p>以下方法，基本都是使用系统的剪贴板管理器<code>ClipboardManager</code>进行内容的复制。</p>
<h2 id="1-LongClick事件-PopupWindow"><a href="#1-LongClick事件-PopupWindow" class="headerlink" title="1. LongClick事件 + PopupWindow"></a>1. LongClick事件 + PopupWindow</h2><p>原理是在TextView的长按事件中，显示一个带操作按钮的PopupWindow，点击其中的<code>复制</code>按钮后，复制TextView内容。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-19-demo11.gif" alt=""></p>
<p><strong>先初始化PopupWindow，弹出窗口上会有复制按钮（也可以自定义其它需要的按钮）：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initPopupWindow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    View popupView = getLayoutInflater().inflate(R.layout.layout_popup_window, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">    mPopupWindow = <span class="keyword">new</span> PopupWindow(popupView, ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT, <span class="keyword">true</span>);</span><br><span class="line">    mPopupWindow.setTouchable(<span class="keyword">true</span>);</span><br><span class="line">    mPopupWindow.setOutsideTouchable(<span class="keyword">true</span>);</span><br><span class="line">    mPopupWindow.setBackgroundDrawable(<span class="keyword">new</span> BitmapDrawable(getResources(), (Bitmap) <span class="keyword">null</span>));</span><br><span class="line"></span><br><span class="line">    Button btnCopy = (Button) popupView.findViewById(R.id.btn_copy);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>然后为ListView中的TextView设置长按事件，在TextView下方显示PopupWindow：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mTextView.setOnLongClickListener(<span class="keyword">new</span> View.OnLongClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onLongClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 方法1：LongClick事件 + PopupWindow</span></span><br><span class="line">        mPopupWindow.showAsDropDown(view);</span><br><span class="line">        mCopiedText = ((TextView) view).getText().toString();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>最后为弹出窗口中的复制按钮设置响应事件，利用ClipboardManager复制TextView内容：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">btnCopy.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        copyText(mCopiedText);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mPopupWindow != <span class="keyword">null</span> &amp;&amp; mPopupWindow.isShowing()) &#123;</span><br><span class="line">            mPopupWindow.dismiss();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">copyText</span><span class="params">(String copiedText)</span> </span>&#123;</span><br><span class="line">    ClipboardManager clipboardManager = (ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);</span><br><span class="line">    clipboardManager.setPrimaryClip(ClipData.newPlainText(<span class="keyword">null</span>, copiedText));</span><br><span class="line"></span><br><span class="line">    showToast(<span class="string">"Copy Text: "</span> + copiedText);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上就可以在你需要输入的地方长按，就会出现<code>粘贴</code>按钮，点击后就能成功粘贴刚才复制的内容了。</p>
<blockquote>
<p>但是这边会有个问题：无法自由选择文字内容，没有选中文字的效果</p>
</blockquote>
<h2 id="2-LongClick事件-ContextMenu"><a href="#2-LongClick事件-ContextMenu" class="headerlink" title="2. LongClick事件 + ContextMenu"></a>2. LongClick事件 + ContextMenu</h2><p>我们也可以使用<a href="https://developer.android.com/guide/topics/ui/menus.html?hl=zh-cn#CAB" target="_blank" rel="external">ContextMenu</a>来手动创建上下文菜单，实现跟原生复制功能一样的效果，在标题栏上方显示可操作的菜单，最终效果如下：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-19-demo12.gif" alt=""></p>
<p><strong>首先，实现 <code>ActionMode.Callback</code> 接口。这里面会包含ActionMode的生命周期方法，在<code>onCreateActionMode()</code>中<code>创建菜单</code>项，如复制、全选等功能菜单，在<code>onActionItemClicked()</code>中处理菜单项的<code>点击事件</code>。</strong>（重点代码用下三角▼▼▼标识了）</p>
<blockquote>
<p>这两个方法就类似标题栏右边的选项菜单<code>OptionsMenu</code>，对应于<code>onCreateOptionsMenu()</code>和<code>onOptionsItemSelected()</code>这两个方法。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ActionMode.Callback mActionModeCallback = <span class="keyword">new</span> ActionMode.Callback() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the action mode is created; startActionMode() was called</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateActionMode</span><span class="params">(ActionMode mode, Menu menu)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Inflate a menu resource providing context menu items</span></span><br><span class="line">        MenuInflater inflater = mode.getMenuInflater();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ▼▼▼重点：创建上下文菜单</span></span><br><span class="line">        inflater.inflate(R.menu.context_menu, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called each time the action mode is shown. Always called after onCreateActionMode, but</span></span><br><span class="line">    <span class="comment">// may be called multiple times if the mode is invalidated.</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onPrepareActionMode</span><span class="params">(ActionMode mode, Menu menu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// Return false if nothing is done</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Called when the user exits the action mode</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroyActionMode</span><span class="params">(ActionMode mode)</span> </span>&#123;</span><br><span class="line">        mActionMode = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>然后，为TextView设置长按事件，显示上下文菜单：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mTextView.setOnLongClickListener(<span class="keyword">new</span> View.OnLongClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onLongClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 方案2：LongClick事件 + ContextMenu</span></span><br><span class="line">        <span class="keyword">if</span> (mActionMode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Start the CAB using the ActionMode.Callback defined above</span></span><br><span class="line">        mActionMode = startActionMode(mActionModeCallback);</span><br><span class="line">        view.setSelected(<span class="keyword">true</span>);</span><br><span class="line">        mCopiedText = ((TextView) view).getText().toString();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>最后，就是在第一步的onActionItemClicked()事件中，为<code>复制</code>按钮设置响应事件，利用ClipboardManager复制TextView内容：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ActionMode.Callback mActionModeCallback = <span class="keyword">new</span> ActionMode.Callback() &#123;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onActionItemClicked</span><span class="params">(ActionMode mode, MenuItem item)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">switch</span> (item.getItemId()) &#123;</span><br><span class="line">	        <span class="comment">// ▼▼▼重点：设置菜单项的点击事件</span></span><br><span class="line">	        <span class="keyword">case</span> R.id.action_copy:</span><br><span class="line">	            copyText(mCopiedText);</span><br><span class="line">	</span><br><span class="line">	            mode.finish(); <span class="comment">// Action picked, so close the CAB</span></span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	        <span class="keyword">default</span>:</span><br><span class="line">	            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这边同样会有上面的问题：无法自由选择文字内容，没有选中文字的效果</p>
</blockquote>
<h2 id="3-Click事件-ClipboardManager"><a href="#3-Click事件-ClipboardManager" class="headerlink" title="3. Click事件 + ClipboardManager"></a>3. Click事件 + ClipboardManager</h2><p>此方案跟第1种原理是一样的，只不过省略了PopupWindow部分，点击后直接自动复制TextView内容，代码比较简单：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mTextView.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        copyText(((TextView) view).getText().toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-19-demo13.gif" alt=""></p>
<blockquote>
<p>问题：无法自由选择文字内容</p>
</blockquote>
<h2 id="4-RecyclerView-textIsSelectable"><a href="#4-RecyclerView-textIsSelectable" class="headerlink" title="4. RecyclerView + textIsSelectable"></a>4. RecyclerView + textIsSelectable</h2><p>其实最推荐的做法，还是将项目里的ListView替换成<code>RecyclerView</code>，再给TextView设置<code>textIsSelectable=true</code>属性即可：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-19-demo14.gif" alt=""></p>
<blockquote>
<p>这让我们再一次见证了RecyclerView的伟大啊～<br>本方案对项目后期维护及扩展更有好处，毕竟现在基本可以说，RecyclerView已经完全取代了ListView，比ListView性能更好，扩展性更强。</p>
</blockquote>
<h2 id="5-额外赠送：SelectableTextHelper"><a href="#5-额外赠送：SelectableTextHelper" class="headerlink" title="5. 额外赠送：SelectableTextHelper"></a>5. 额外赠送：SelectableTextHelper</h2><p>网上还有位大神自定义了可选择TextView内容的帮助类，使用上非常方便，只要对原来的TextView加上如下设置即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mSelectableTextHelper = <span class="keyword">new</span> SelectableTextHelper.Builder(mTextView)</span><br><span class="line">    .setSelectedColor(getResources().getColor(R.color.selected_blue))</span><br><span class="line">    .setCursorHandleSizeInDp(<span class="number">20</span>)</span><br><span class="line">    .setCursorHandleColor(getResources().getColor(R.color.cursor_handle_color))</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>有兴趣的同学可以参考此文章了解更多：<a href="http://jaeger.itscoder.com/android/2016/11/21/selectable-text-helper.html" target="_blank" rel="external">自定义选择复制功能的实现</a></p>
<blockquote>
<p>亲测在文字选择时，左右两边选择文字范围的图标不好点中，应该是坐标处理有点问题；而且无法在ListView中使用；但不得不说，整体效果非常好，对代码的侵入非常少，在各个平台上的体验也是统一的。</p>
</blockquote>
<h1 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h1><p>这几种方案来看的话：</p>
<ul>
<li>如果项目中需要复制的TextView没有嵌套在ListView中，那就可以直接大胆地使用<code>textIsSelectable</code>属性，一步搞定；</li>
<li>如果使用到ListView，能改成RecyclerView来实现的话，建议直接改成RecyclerView，再加上<code>textIsSelectable</code>属性，也很好解决；（方案4）</li>
<li>如果非要用ListView的话，看看是否能在满足项目需求的情况下，直接使用TextView的点击事件，配合<code>ClipboardManager</code>直接自动复制指定内容，但记得在复制完成后给用户显示必要的提示。（方案3）========&gt; 本项目就是使用这种方案简单粗暴地解决ListView中无法长按选择复制TextView内容的问题的。</li>
<li>如果这几种方案还不能解决你的问题，可以在其余几种方案中看看是否有符合要求的。</li>
</ul>
<h1 id="七、疑问"><a href="#七、疑问" class="headerlink" title="七、疑问"></a>七、疑问</h1><p>虽然项目问题解决了，但是还有以下几个问题，在查看了相关源码、进行一系列测试后，还是未能解决，暂且记录下来，说不定以后什么时候能力达到了，就能解决了呢？或者哪位小伙伴知道原因，还请不吝赐教～</p>
<ul>
<li>为什么设置<code>textIsSelectable</code>为<code>true</code>后，ListView的ItemClick事件不响应了，明明该有的DOWN、MOVE、UP事件还是有？ItemClick的触发条件是什么？</li>
<li>而这时候，为什么TextView不会弹出选中框，以及复制、全选等操作按钮？而在添加了<code>android:selectAllOnFocus=&quot;true&quot;</code>后，长按后显示红色选择框，但不显示复制按钮，再次点击红色选择框，就会出现复制按钮。</li>
<li>TextView长按后，在LongClick事件之后，就不再有Touch事件产生（如附录最后一项测试结果，以下附录只是记录而已）</li>
</ul>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h2 id="1-当textIsSelectable为false时"><a href="#1-当textIsSelectable为false时" class="headerlink" title="1. 当textIsSelectable为false时"></a>1. 当<code>textIsSelectable</code>为<code>false</code>时</h2><h3 id="1-1-未设置TextView的点击、长按事件："><a href="#1-1-未设置TextView的点击、长按事件：" class="headerlink" title="1.1 未设置TextView的点击、长按事件："></a>1.1 未设置TextView的点击、长按事件：</h3><p>点击ListView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>点击TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>长按TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<h3 id="1-2-有设置TextView的点击、长按事件："><a href="#1-2-有设置TextView的点击、长按事件：" class="headerlink" title="1.2 有设置TextView的点击、长按事件："></a>1.2 有设置TextView的点击、长按事件：</h3><p>点击ListView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>点击TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↑↑↑ACTION_UP↑↑↑</span><br><span class="line">TextView: ↓onClick↓</span><br></pre></td></tr></table></figure>
<p>长按TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↓↓onLongClick↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↑↑↑ACTION_UP↑↑↑</span><br><span class="line">TextView: ↓onClick↓</span><br></pre></td></tr></table></figure>
<h2 id="2-当textIsSelectable为true时"><a href="#2-当textIsSelectable为true时" class="headerlink" title="2. 当textIsSelectable为true时"></a>2. 当<code>textIsSelectable</code>为<code>true</code>时</h2><h3 id="2-1-未设置TextView的点击、长按事件："><a href="#2-1-未设置TextView的点击、长按事件：" class="headerlink" title="2.1 未设置TextView的点击、长按事件："></a>2.1 未设置TextView的点击、长按事件：</h3><p>点击ListView：(ItemClick事件未响应)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>点击TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>长按TextView：（显示出红色选中框后，不再有事件产生）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br></pre></td></tr></table></figure>
<h3 id="2-2-有设置TextView的点击、长按事件："><a href="#2-2-有设置TextView的点击、长按事件：" class="headerlink" title="2.2 有设置TextView的点击、长按事件："></a>2.2 有设置TextView的点击、长按事件：</h3><p>点击ListView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">ListView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">ListView: ↑↑↑ACTION_UP↑↑↑</span><br></pre></td></tr></table></figure>
<p>点击TextView：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↑↑↑ACTION_UP↑↑↑</span><br><span class="line">TextView: ↓onClick↓</span><br></pre></td></tr></table></figure>
<p>长按TextView：（onLongClick事件产生后，又产生了一次MOVE事件，然后不再有事件产生）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TextView: ↓↓↓ACTION_DOWN↓↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br><span class="line">...</span><br><span class="line">TextView: ↓↓onLongClick↓↓</span><br><span class="line">TextView: →→→ACTION_MOVE→→→</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PS：欢迎关注<a href="http://sherlockshi.github.io/">SherlockShi博客</a></p>
</blockquote>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/" 
            data-url="http://sherlockshi.github.io/2016/12/19/15_Android/1590_Others/Android复制TextView内容常用方法汇总/"
            data-title="Android复制TextView内容常用方法汇总"></div>
    <!-- 多说评论框 end -->
</div>



            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="SherlockShi's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        sherlock_shi@163.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="mailto:sherlock_shi@163.com" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">96</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">3</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="/tags/" title="标签">
				标签
			</a>
		</li>
	
		<li>
			<a href="/links/" title="友情链接">
				友情链接
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">119</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">

    
    <!-- Paradox Footer Left Section -->
    <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/2283093752" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/sherlockshi" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


    <!--Copyright-->
    <div id="copyright">Copyright&nbsp;©&nbsp;
        <script type="text/javascript">var fd = new Date();
            document.write(fd.getFullYear());</script>
        &nbsp;SherlockShi's Home

        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <div>
            本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp
            你是第 <span id="busuanzi_value_site_uv"></span> 个来到的小伙伴
        </div>
    </div>

    <div>

    </div>

    <!-- Paradox Footer Right Section -->

    <!--
    I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
    It will not impact the appearance and can give developers a lot of support :)

    很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
    它不会影响美观并可以给开发者很大的支持。 :)
    -->

    <div class="mdl-mini-footer--right-section">
        <div>
            <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank"
                                                          class="footer-develop-a">Hexo</a></div>
            <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material"
                                                       target="_blank" class="footer-develop-a">Material</a></div>
        </div>
    </div>
    

</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>




    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("H2W8h4AbtEwoE7j8i0AA9ABU-gzGzoHsz", "44qGllcHkSbi5usA2bihFiN1");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>



    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"sherlockshi"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
