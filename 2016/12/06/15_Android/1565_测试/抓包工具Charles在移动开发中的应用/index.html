<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        抓包工具Charles在移动开发中的应用 | SherlockShi&#39;s Home
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="SherlockShi">
    <meta name="description" content="Don&#39;t be evil.">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="SherlockShi&#39;s Home">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://sherlockshi.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="抓包工具Charles在移动开发中的应用 | SherlockShi&#39;s Home">
    <meta property="og:description" content="Don&#39;t be evil.">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
        
			<!-- GoogleAnalytics -->
			<script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-85064715-1', 'auto'); ga('send', 'pageview');
</script>
        
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一、前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#二、安装和激活"><span class="post-toc-number">2.</span> <span class="post-toc-text">二、安装和激活</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#三、Charles主界面介绍"><span class="post-toc-number">3.</span> <span class="post-toc-text">三、Charles主界面介绍</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-两种视图模式"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1. 两种视图模式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-过滤关键字"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2. 过滤关键字</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-请求内容和响应内容"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">3. 请求内容和响应内容</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#四、截取移动设备上的网络封包"><span class="post-toc-number">4.</span> <span class="post-toc-text">四、截取移动设备上的网络封包</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-Charles设置"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">1. Charles设置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-手机设置"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">2. 手机设置</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#五、断点"><span class="post-toc-number">5.</span> <span class="post-toc-text">五、断点</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#六、慢速网络"><span class="post-toc-number">6.</span> <span class="post-toc-text">六、慢速网络</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#七、其它"><span class="post-toc-number">7.</span> <span class="post-toc-text">七、其它</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#八、参考资料"><span class="post-toc-number">8.</span> <span class="post-toc-text">八、参考资料</span></a></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 7 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            抓包工具Charles在移动开发中的应用
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>SherlockShi</strong>
        <span>12月 06, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Charles/">Charles</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/抓包/">抓包</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/移动开发/">移动开发</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/" class="leancloud-views_num" data-flag-title="抓包工具Charles在移动开发中的应用">
     &nbsp;浏览量
</span>
        </li>
    </a>
    
    
    
    <!-- Busuanzi Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="busuanzi_container_page_pv">
                <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
            </span>
        </li>
    </a>
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=抓包工具Charles在移动开发中的应用&url=http://sherlockshi.github.io//2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/index.html&via=SherlockShi" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://sherlockshi.github.io//2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=抓包工具Charles在移动开发中的应用&url=http://sherlockshi.github.io//2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-074025.jpg" alt="Charles"></p>
<p>Charles是一个Web代理服务器（HTTP代理 / HTTP监视器），是一个常用的网络封包截取工具，在做移动开发时，我们为了调试与服务器端的网络通讯协议，常常需要截取网络封包来分析。</p>
<a id="more"></a>
<p>Charles 通过将自己设置成系统的网络访问代理服务器，使得所有的网络访问请求都通过它来完成，从而实现了网络封包的截取和分析。</p>
<p>Charles的主要功能包括：</p>
<ul>
<li>SSL代理</li>
<li>流量控制：可以模拟慢速网络以及等待时间（latency）较长的请求</li>
<li>AJAX调试：可以自动将json或xml数据格式化</li>
<li>AMF</li>
<li>重发网络请求，方便后端调试</li>
<li>支持修改网络请求参数</li>
<li>可设置断点来拦截请求和响应数据</li>
<li>检查HTML，CSS和RSS内容是否符合W3C标准</li>
</ul>
<p>本文主要介绍在移动开发中常用的几个功能，希望能对移动开发人员有一定的帮助。</p>
<h1 id="二、安装和激活"><a href="#二、安装和激活" class="headerlink" title="二、安装和激活"></a>二、安装和激活</h1><p>Charles是收费软件，可以免费试用30天。试用期过后，未付费的用户仍然可以继续使用，但是每次使用时间不能超过30分钟，并且启动时将会有10秒种的延时。</p>
<p>不差钱的小主儿可直接到<a href="https://www.charlesproxy.com/download/" target="_blank" rel="external">Charles官网</a>下载相应操作系统版本，并根据需求在<a href="https://www.charlesproxy.com/buy/" target="_blank" rel="external">这里</a>购买相应的License。</p>
<p>但我相信，更多的小主儿还是觉得在天朝这个神奇的国度，免费才是王道。</p>
<ul>
<li>Mac版可上<a href="http://xclient.info/s/charles.html" target="_blank" rel="external">Xclient</a>下载，里面的软件一般会有多个版本，更重要的是，都会有激活方法，实在是良心网站啊～</li>
<li>至于Windows版的话，百度谷歌搜索一下，或者官网下载之后，网上搜下注册码，相信在天朝生活了几十年的各位小主儿混得比我还开。</li>
</ul>
<h1 id="三、Charles主界面介绍"><a href="#三、Charles主界面介绍" class="headerlink" title="三、Charles主界面介绍"></a>三、Charles主界面介绍</h1><p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-070425.jpg?imageView2/2/w/600/" alt="Charles主界面介绍"></p>
<h2 id="1-两种视图模式"><a href="#1-两种视图模式" class="headerlink" title="1. 两种视图模式"></a>1. 两种视图模式</h2><p>Charles 主要提供两种查看封包的视图，分别名为<code>Structure</code>和<code>Sequence</code>。</p>
<ul>
<li>Structure： 视图将网络请求按访问的<code>域名分类</code>。</li>
<li>Sequence： 视图将网络请求按访问的<code>时间排序</code>。</li>
</ul>
<h2 id="2-过滤关键字"><a href="#2-过滤关键字" class="headerlink" title="2. 过滤关键字"></a>2. 过滤关键字</h2><p>一般我们可以直接在Filter栏中输入需要的关键字，来筛选出关注的网络请求，比如我们的服务器地址是：<code>www.youraddress.com</code>，那我们就可以直接在Filter栏中输入：<code>youraddress</code>来过滤。</p>
<h2 id="3-请求内容和响应内容"><a href="#3-请求内容和响应内容" class="headerlink" title="3. 请求内容和响应内容"></a>3. 请求内容和响应内容</h2><p>在界面下方，还可以看到本次请求的概述（Overview）、请求内容（Request）、响应内容（Response）等一系列信息：</p>
<ul>
<li>概述：包含了URL、请求状态、请求时间、请求数据大小、响应数据大小等信息</li>
</ul>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-071939.jpg?imageView2/2/w/600/" alt="概述"></p>
<ul>
<li>请求内容：包含了请求头信息（请求方式、URL、协议、User-Agent、Host等信息）</li>
</ul>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-071344.jpg?imageView2/2/w/600/" alt="请求内容"></p>
<ul>
<li>响应内容：包含了请求头、响应数据包内容等信息，而响应数据又可以按原格式、Json格式、Json Text格式进行显示，如果响应内容是图片，Charles还可以显示出图片的预览，极大地方便了数据的阅读</li>
</ul>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-071528.jpg?imageView2/2/w/600/" alt="响应内容"></p>
<h1 id="四、截取移动设备上的网络封包"><a href="#四、截取移动设备上的网络封包" class="headerlink" title="四、截取移动设备上的网络封包"></a>四、截取移动设备上的网络封包</h1><p>介绍完Charles的基础使用方法后，接下来就进入本文的正题，也就是怎么在移动开发中使用Charles来截取移动设备上的网络封包，进行数据分析。本文以Android设备为例进行讲解。</p>
<p>首先我们需要保证电脑和移动设备使用的是<code>同一个局域网</code>，然后我们需要将移动设备的网络代理设置为电脑的IP和端口号。</p>
<h2 id="1-Charles设置"><a href="#1-Charles设置" class="headerlink" title="1. Charles设置"></a>1. Charles设置</h2><p>我们首先需要将 Charles 的代理功能打开。在 Charles 的菜单栏上选择<code>Proxy</code> -&gt; <code>Proxy Settings</code>，填入代理端口 <code>8888</code>（请记住此端口号，后面Android设备的设置中会用到），并且勾上<code>Enable transparent HTTP proxying</code>就完成了在 Charles 上的设置:</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-073417.jpg?imageView2/2/w/400/" alt="Charles设置"></p>
<h2 id="2-手机设置"><a href="#2-手机设置" class="headerlink" title="2. 手机设置"></a>2. 手机设置</h2><p>首先我们需要获取 Charles 运行所在电脑的 IP 地址，Charles 的菜单栏的<code>Help</code> -&gt; <code>Local IP Address</code>，即可在弹出的对话框中看到 IP 地址：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-074132.jpg?imageView2/2/w/400/" alt=""></p>
<p>在手机的<code>设置</code> -&gt; <code>WLAN</code>中，可以看到当前连接的 wifi 名称：</p>
<ul>
<li>长按</li>
<li>点击<code>修改网络</code></li>
<li>打开<code>高级选项</code></li>
<li>在<code>代理</code>一栏选择<code>手动</code></li>
<li><code>代理服务器器主机名</code>填写第1步看到的电脑IP：<code>192.168.1.101</code></li>
<li><code>代理服务器端口</code>填写<code>Charles设置</code>中填入的商品号：<code>8888</code></li>
<li>保存</li>
</ul>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-082244.jpg" alt="Android设置"></p>
<p>设置好之后，我们打开手机上的任意需要网络通讯的程序，就可以看到 Charles 弹出手机请求连接的确认菜单，点击 “Allow” 即可完成设置。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-082616.jpg?imageView2/2/w/400/" alt="手机连接请求"></p>
<p>之后，我们就可以在Charles上看到手机网络请求的所有数据了。</p>
<h1 id="五、断点"><a href="#五、断点" class="headerlink" title="五、断点"></a>五、断点</h1><p>Breakpoints 功能类似我们在Android Studio、Eclipse、Xcode等开发环境中设置的断点一样，当指定的网络请求发生时，Charles 会截获该请求，这时候我们可以在 Charles 中临时修改网络请求的请求内容、响应内容。</p>
<p>右击我们需要设置断点的请求，选择<code>Breakpoints</code>：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-085601.jpg?imageView2/2/w/600/" alt=""></p>
<p>然后选择菜单栏<code>Proxy</code> -&gt; <code>Breakpoint Settings...</code></p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-085332.jpg?imageView2/2/w/400/" alt=""></p>
<p>双击我们要设置断点的请求，进入编辑：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-085425.jpg?imageView2/2/w/400/" alt=""></p>
<p>在这里，我们可以编辑断点的相关参数，常用的功能是根据需要为<code>请求内容（Request）</code>或<code>响应内容（Response）</code>设置断点，即图上的两个复选框，默认为请求内容和响应内容都设置断点，即当发起这个网络请求、以及收到服务器返回的响应数据时，都会进入断点；当然，我们也可以只跟踪Request或Response。</p>
<p>当我们发起这个断点设置的网络请求时，会进入断点，我们就可以修改请求参数：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-090113.jpg?imageView2/2/w/600/" alt=""></p>
<p>当服务器返回数据后，也可以修改返回数据，这里我们常用来修改返回标识（如成功、失败）、修改返回数据（无数据、数据内容为指定值），再查看我们的客户端程序的处理是否正确。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-090338.jpg?imageView2/2/w/600/" alt=""></p>
<blockquote>
<ul>
<li>除了设置断点来修改请求数据，还可以使用<a href="http://blog.devtang.com/2015/11/14/charles-introduction/#u4FEE_u6539_u7F51_u7EDC_u8BF7_u6C42_u5185_u5BB9" target="_blank" rel="external">网络请求的修改和重发功能</a>来进行请求数据的修改和重发。（右键菜单里的<code>Edit</code>已改成<code>Compose</code>，可能是4.0的时候改的，使用时请注意一下）  </li>
<li>另外也可以使用<a href="http://blog.devtang.com/2015/11/14/charles-introduction/#Map__u529F_u80FD" target="_blank" rel="external">Map 功能</a>、 <a href="http://blog.devtang.com/2015/11/14/charles-introduction/#Rewrite__u529F_u80FD" target="_blank" rel="external">Rewrite 功能</a>对响应数据进行长期和批量的修改。</li>
</ul>
</blockquote>
<h1 id="六、慢速网络"><a href="#六、慢速网络" class="headerlink" title="六、慢速网络"></a>六、慢速网络</h1><p>在做移动开发的时候，我们常常需要模拟慢速网络或者高延迟的网络，以测试在移动网络下，应用的表现是否正常。Charles 对此需求提供了很好的支持。</p>
<p>在菜单栏上选择<code>Proxy</code> -&gt; <code>Throttle Setting</code>，在之后弹出的对话框中，我们可以勾选上<code>Enable Throttling</code>，并且可以设置<code>Throttle Preset</code>的类型。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-12-06-091546.jpg?imageView2/2/w/300/" alt=""></p>
<p>如果我们只想模拟指定网站的慢速网络，可以再勾选上图中的<code>Only for selected hosts</code>项，然后在对话框的下半部分设置中增加指定的<code>hosts</code>即可。</p>
<h1 id="七、其它"><a href="#七、其它" class="headerlink" title="七、其它"></a>七、其它</h1><p>Charles除了以上功能，还可以：</p>
<ul>
<li>修改、重发网络请求</li>
<li>压力测试</li>
<li>Map</li>
<li>Rewrite</li>
<li>反向代理</li>
<li>截取HTTPS通讯信息（需安装SSL证书）</li>
</ul>
<p>如有需要，请查阅以下参考资料或相关文档。</p>
<h1 id="八、参考资料"><a href="#八、参考资料" class="headerlink" title="八、参考资料"></a>八、参考资料</h1><p><a href="https://www.charlesproxy.com/" target="_blank" rel="external">Charles官网</a><br><a href="http://blog.devtang.com/2015/11/14/charles-introduction/" target="_blank" rel="external">Charles 从入门到精通</a>  </p>
<blockquote>
<p>PS：欢迎关注<a href="http://sherlockshi.github.io/">SherlockShi博客</a></p>
</blockquote>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/" 
            data-url="http://sherlockshi.github.io/2016/12/06/15_Android/1565_测试/抓包工具Charles在移动开发中的应用/"
            data-title="抓包工具Charles在移动开发中的应用"></div>
    <!-- 多说评论框 end -->
</div>



            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/12/03/15_Android/1530_开发工具/AndroidStudio/Android Studio加速编译方法汇总/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="SherlockShi's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        sherlock_shi@163.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="mailto:sherlock_shi@163.com" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">96</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">3</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="/tags/" title="标签">
				标签
			</a>
		</li>
	
		<li>
			<a href="/links/" title="友情链接">
				友情链接
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">118</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">

    
    <!-- Paradox Footer Left Section -->
    <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/2283093752" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/sherlockshi" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


    <!--Copyright-->
    <div id="copyright">Copyright&nbsp;©&nbsp;
        <script type="text/javascript">var fd = new Date();
            document.write(fd.getFullYear());</script>
        &nbsp;SherlockShi's Home

        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <div>
            本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp
            你是第 <span id="busuanzi_value_site_uv"></span> 个来到的小伙伴
        </div>
    </div>

    <div>

    </div>

    <!-- Paradox Footer Right Section -->

    <!--
    I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
    It will not impact the appearance and can give developers a lot of support :)

    很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
    它不会影响美观并可以给开发者很大的支持。 :)
    -->

    <div class="mdl-mini-footer--right-section">
        <div>
            <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank"
                                                          class="footer-develop-a">Hexo</a></div>
            <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material"
                                                       target="_blank" class="footer-develop-a">Material</a></div>
        </div>
    </div>
    

</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>




    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("H2W8h4AbtEwoE7j8i0AA9ABU-gzGzoHsz", "44qGllcHkSbi5usA2bihFiN1");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>



    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"sherlockshi"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
