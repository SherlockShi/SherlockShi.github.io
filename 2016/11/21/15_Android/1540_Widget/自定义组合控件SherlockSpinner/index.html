<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        Android自定义组合控件：SherlockSpinner | SherlockShi&#39;s Home
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="SherlockShi">
    <meta name="description" content="Don&#39;t be evil.">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="SherlockShi&#39;s Home">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://sherlockshi.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Android自定义组合控件：SherlockSpinner | SherlockShi&#39;s Home">
    <meta property="og:description" content="Don&#39;t be evil.">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #00838F
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #0097A7 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #0097A7 !important
    }
    
    .toTop{
        background: #757575 !important
    }
		
	.material-layout .material-post>.material-nav,
	.material-layout .material-index>.material-nav,
	.material-nav a{
		color: #757575;
	}
		
	#scheme-Paradox .MD-burger-layer {
		background-color: #757575;
	}

	#scheme-Paradox #post-toc-trigger-btn{
		color: #757575;
	}
	
	.post-toc a:hover{
		color: #00838F;
		text-decoration: underline;
	}
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-color: #F5F5F5
        }
		
		/* blog_info bottom background */
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>

	<script src="/js/jquery.min.js"></script>
	
	<link rel="stylesheet" href="/css/highlight/solarized-white.css">
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
        
			<!-- GoogleAnalytics -->
			<script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-85064715-1', 'auto'); ga('send', 'pageview');
</script>
        
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
<!--
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			
-->
	<!-- Left aligned menu below button -->
	<button id="post-toc-trigger-btn"
			class="mdl-button mdl-js-button mdl-button--icon">
	  <i class="material-icons">format_list_numbered</i>
	</button>

	<ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
		for="post-toc-trigger-btn">
			
			<ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一、前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#二、使用系统Spinner"><span class="post-toc-number">2.</span> <span class="post-toc-text">二、使用系统Spinner</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-首先，我想到的便是使用系统的Spinner，说干就干，XML先上："><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1. 首先，我想到的便是使用系统的Spinner，说干就干，XML先上：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件："><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2. 然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件：</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-接着我们来设置点击事件"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3. 接着我们来设置点击事件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-那我们就设置Touch事件喽："><span class="post-toc-number">2.4.</span> <span class="post-toc-text">4. 那我们就设置Touch事件喽：</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#二、CustomSpinner-EditText-ListPopupWindow"><span class="post-toc-number">3.</span> <span class="post-toc-text">二、CustomSpinner = EditText + ListPopupWindow</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-XML布局"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1. XML布局</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-代码中创建ListPopupWindow"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2. 代码中创建ListPopupWindow</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-小结"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">3. 小结</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#三、自定义组合控件"><span class="post-toc-number">4.</span> <span class="post-toc-text">三、自定义组合控件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-引入依赖"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">1. 引入依赖</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-使用方法"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">2. 使用方法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-像使用系统Spinner一样，在XML文件中使用"><span class="post-toc-number">4.2.1.</span> <span class="post-toc-text">2.1 像使用系统Spinner一样，在XML文件中使用:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-2-还是像使用系统Spinner一样，在代码中设置Adapter和ItemClickListener"><span class="post-toc-number">4.2.2.</span> <span class="post-toc-text">2.2 还是像使用系统Spinner一样，在代码中设置Adapter和ItemClickListener:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-3-可选-如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理"><span class="post-toc-number">4.2.3.</span> <span class="post-toc-text">2.3 (可选) 如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-更多属性"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">3. 更多属性</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#四、其它"><span class="post-toc-number">5.</span> <span class="post-toc-text">四、其它</span></a></li></ol>
		
<!--			<li class="mdl-menu__item">Some Action</li>-->
	</ul>


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
		
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 7 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            Android自定义组合控件：SherlockSpinner
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>SherlockShi</strong>
        <span>11月 21, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Android/">Android</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/Spinner/">Spinner</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/自定义控件/">自定义控件</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/" class="leancloud-views_num" data-flag-title="Android自定义组合控件：SherlockSpinner">
     &nbsp;浏览量
</span>
        </li>
    </a>
    
    
    
    <!-- Busuanzi Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="busuanzi_container_page_pv">
                <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
            </span>
        </li>
    </a>
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Android自定义组合控件：SherlockSpinner&url=http://sherlockshi.github.io//2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/index.html&via=SherlockShi" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://sherlockshi.github.io//2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Android自定义组合控件：SherlockSpinner&url=http://sherlockshi.github.io//2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<p>如果你觉得从头开始自定义一个View比较麻烦，那么组合几个系统现有控件来实现需求的功能，会是你很好的一个选择。</p>
<a id="more"></a>
<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>最近在项目中，需要使用Spinner来实现下拉选择功能，UI方面倒是要求不多。但是难点在于一个界面中有多个Spinner，并且有联动关系，数据需要在点击Spinner的时候请求服务器。而且当前Spinner数据依赖于前面选择的一个或多个结果，当获取到最新数据后，才显示下拉选项。</p>
<p>比如说我需要先选择一个仓库，再选择项目（依赖前面选择的仓库），再选择一个批次（依赖前面选择的仓库和项目），如果我在选择完仓库时，就去判断来预加载项目和批次的数据，会使依赖逻辑变得非常复杂。</p>
<p>这时候就想在每次点击一个Spinner的时候，去判断依赖的选项是否已经选择，未选择就提示需先选择；如果已选择，则进行网络请求，加载数据显示到下拉选项中。</p>
<p>（本例使用选择语言来进行演示。）</p>
<h1 id="二、使用系统Spinner"><a href="#二、使用系统Spinner" class="headerlink" title="二、使用系统Spinner"></a>二、使用系统Spinner</h1><h2 id="1-首先，我想到的便是使用系统的Spinner，说干就干，XML先上："><a href="#1-首先，我想到的便是使用系统的Spinner，说干就干，XML先上：" class="headerlink" title="1. 首先，我想到的便是使用系统的Spinner，说干就干，XML先上："></a>1. 首先，我想到的便是使用系统的Spinner，说干就干，XML先上：</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Spinner</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/spn_languages"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"36dp"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件："><a href="#2-然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件：" class="headerlink" title="2. 然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件："></a>2. 然后代码设置Adapter匹配数据、设置OnItemSelectedListener绑定item选择的事件：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">spnLanguages = (Spinner) findViewById(R.id.spn_languages);</span><br><span class="line">ArrayAdapter&lt;String&gt; mAdapterSystemSpinner = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, android.R.layout.simple_list_item_1, mLanguages);</span><br><span class="line">spnLanguages.setAdapter(mAdapterSystemSpinner);</span><br><span class="line">spnLanguages.setOnItemSelectedListener(<span class="keyword">new</span> AdapterView.OnItemSelectedListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemSelected</span><span class="params">(AdapterView&lt;?&gt; parent, View view, <span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        showMessage(<span class="string">"Select "</span> + mLanguages[position]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNothingSelected</span><span class="params">(AdapterView&lt;?&gt; parent)</span> </span>&#123;</span><br><span class="line">        showMessage(<span class="string">"Select Nothing."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>OK，现在Spinner可以使用了：</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-11-20-demo4.gif" alt=""></p>
<h2 id="3-接着我们来设置点击事件"><a href="#3-接着我们来设置点击事件" class="headerlink" title="3. 接着我们来设置点击事件"></a>3. 接着我们来设置点击事件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spnLanguages.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        showMessage(<span class="string">"Click Spinner"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>什么情况，运行后直接崩了？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FATAL EXCEPTION: main</span><br><span class="line">Process: com.sherlockshi.widget.sherlockspinner, PID: 11757</span><br><span class="line">java.lang.RuntimeException: Unable to start activity ComponentInfo&#123;com.sherlockshi.widget.sherlockspinner/com.sherlockshi.widget.MainActivity&#125;: java.lang.RuntimeException: Don&apos;t call setOnClickListener for an AdapterView. You probably want setOnItemClickListener instead</span><br><span class="line">   ...</span><br><span class="line">Caused by: java.lang.RuntimeException: Don&apos;t call setOnClickListener for an AdapterView. You probably want setOnItemClickListener instead</span><br><span class="line">   at android.widget.AdapterView.setOnClickListener(AdapterView.java:798)</span><br><span class="line">   at com.sherlockshi.widget.MainActivity.initSystemSpinner(MainActivity.java:169)</span><br><span class="line">   at com.sherlockshi.widget.MainActivity.onCreate(MainActivity.java:48)</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure>
<p>简单来说就是，<code>AdapterView</code>不能设置Click事件，看下Spinner源码，确实是继承自<code>AdapterView</code>。（至于为什么<code>AdapterView</code>不能设置Click事件，这个暂未深究。）</p>
<h2 id="4-那我们就设置Touch事件喽："><a href="#4-那我们就设置Touch事件喽：" class="headerlink" title="4. 那我们就设置Touch事件喽："></a>4. 那我们就设置Touch事件喽：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">spnLanguages.setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                showMessage(<span class="string">"Touch Spinner"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这下确实是可以响应点击事件了，但是响应完，下拉选择就直接显示出来了，无法满足我们的需求。</p>
<p>而且Spinner还有个问题，一进入界面的时候，默认就会选择第一项，而我们并不需要这样的默认值。</p>
<h1 id="二、CustomSpinner-EditText-ListPopupWindow"><a href="#二、CustomSpinner-EditText-ListPopupWindow" class="headerlink" title="二、CustomSpinner = EditText + ListPopupWindow"></a>二、CustomSpinner = EditText + ListPopupWindow</h1><p>那我们是否可以使用别的控件，来实现相同的功能呢？答案是肯定的，我们用EditText来接收点击事件，而在请求完数据之后，使用ListPopupWindow来显示下拉选项，选择EditText的原因主要有以下几点：</p>
<ul>
<li>默认在底部会有带颜色的横线，Material Design风格的EditText看起来效果很不赖</li>
<li>EditText可以方便的配置上、下、左、右四个位置的小图标，我们可以在右侧放置一个向下的三角箭头，使它看起来像一个系统的Spinner</li>
</ul>
<p>而选择ListPopupWindow则是因为：</p>
<ul>
<li>可以方便的使用下拉列表</li>
<li>可以自由设置锚点</li>
</ul>
<h2 id="1-XML布局"><a href="#1-XML布局" class="headerlink" title="1. XML布局"></a>1. XML布局</h2><p>布局文件依旧很简单，只要一个简单的EditText，配上一个右侧的下拉图标：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/et_languages"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">    <span class="attr">android:gravity</span>=<span class="string">"right"</span></span><br><span class="line">    <span class="attr">android:drawableRight</span>=<span class="string">"@drawable/ic_dropdown"</span></span><br><span class="line">    <span class="attr">android:hint</span>=<span class="string">"Please Select..."</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-代码中创建ListPopupWindow"><a href="#2-代码中创建ListPopupWindow" class="headerlink" title="2. 代码中创建ListPopupWindow"></a>2. 代码中创建ListPopupWindow</h2><p>此部分包含以下逻辑：</p>
<ul>
<li>初始化ListPopupWindow，并关联到EditText上</li>
<li>当点击EditText时，请求数据，请求完成后，显示ListPopupWindow</li>
<li>选中ListPopupWindow的某一项后，将此项内容更新到EditText中，并隐藏ListPopupWindow</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">etLanguages = (EditText) findViewById(R.id.et_languages);</span><br><span class="line">etLanguages.setKeyListener(<span class="keyword">null</span>); <span class="comment">// 设置EditText不可编辑，等同于在xml中设置editable="false"</span></span><br><span class="line">lpwLanguages = <span class="keyword">new</span> ListPopupWindow(<span class="keyword">this</span>);</span><br><span class="line">mAdapterLanguages = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, android.R.layout.simple_list_item_1, mLanguages);</span><br><span class="line">lpwLanguages.setAdapter(mAdapterLanguages);</span><br><span class="line">lpwLanguages.setAnchorView(etLanguages); <span class="comment">//设置ListPopupWindow的锚点，即关联PopupWindow的显示位置</span></span><br><span class="line">lpwLanguages.setModal(<span class="keyword">true</span>); <span class="comment">// 是否为模态，当设置为true时，会处理返回按键的事件</span></span><br><span class="line"></span><br><span class="line">lpwLanguages.setOnItemClickListener(<span class="keyword">new</span> AdapterView.OnItemClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; parent, View view, <span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        showMessage(<span class="string">"Select "</span> + mLanguages[position]);</span><br><span class="line"></span><br><span class="line">        etLanguages.setText(mLanguages[position]);</span><br><span class="line">        lpwLanguages.dismiss();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果使用onClick事件，会出现第一次点击只获取焦点，第二次点击才出现下拉</span></span><br><span class="line">etLanguages.setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getAction() == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">            <span class="comment">// Do what you want</span></span><br><span class="line">            getDataFromNet();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDataFromNet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 延时2秒后，修改源数据，用来模拟网络请求</span></span><br><span class="line">    <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mLanguages[<span class="number">1</span>] = <span class="string">"C+++++++++++++"</span>;</span><br><span class="line">            mAdapterLanguages.notifyDataSetChanged();</span><br><span class="line"></span><br><span class="line">            runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    lpwLanguages.show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现效果如下所示：<br><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-11-21-demo10.gif" alt=""></p>
<h2 id="3-小结"><a href="#3-小结" class="headerlink" title="3. 小结"></a>3. 小结</h2><p>EditText配合ListPopupWindow组合实现Spinner的功能，使用起来倒是简单，逻辑也挺清晰的，但是如果界面上有三四个Spinner，那不是就得把类似的代码写上三四遍？</p>
<p>其实我们并不关心内部是用ListPopupWindow或者其它的控件来实现，也不想处理任何关于ListPopupWindow的细节。我们关心的只有Spinner的初始化、适配数据、Item选择事件（ItemClick事件），如果可以，就再加上Spinner的点击事件（Click或Touch事件）、自由控制Spinner的显示时机。</p>
<p>那有没有简单易用的方法，可以直接像使用系统的Spinner一样，来使用EditText和ListPopupWindow的组合呢？并且可以提供Spinner的点击事件？答案是肯定的，详情且看下一节。</p>
<h1 id="三、自定义组合控件"><a href="#三、自定义组合控件" class="headerlink" title="三、自定义组合控件"></a>三、自定义组合控件</h1><p>在第二部分我们可以看出，我们的控件要满足以下两大功能：</p>
<ol>
<li>像系统Spinner一样简单易用：初始化、适配数据、Item选择事件（ItemClick事件）</li>
<li>支持点击事件（Click或Touch事件），自由控制下拉框显示时机</li>
</ol>
<p>由于控件源码稍长，就不贴出来了，有兴趣可以点击文末的Github链接，源码也比较简单，只是进行控件的组合，并提供相应的方法进行调用，下面主要介绍下使用方法。</p>
<h2 id="1-引入依赖"><a href="#1-引入依赖" class="headerlink" title="1. 引入依赖"></a>1. 引入依赖</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    compile <span class="string">'com.sherlockshi.widget:sherlockspinner:1.0.2'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-使用方法"><a href="#2-使用方法" class="headerlink" title="2. 使用方法"></a>2. 使用方法</h2><h3 id="2-1-像使用系统Spinner一样，在XML文件中使用"><a href="#2-1-像使用系统Spinner一样，在XML文件中使用" class="headerlink" title="2.1 像使用系统Spinner一样，在XML文件中使用:"></a>2.1 像使用系统Spinner一样，在XML文件中使用:</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.sherlockshi.widget.SherlockSpinner</span></span><br><span class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/sherlock_spinner"</span></span><br><span class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span><br><span class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span><br><span class="line">    <span class="attr">app:lineColor</span>=<span class="string">"#00FF00"</span></span><br><span class="line">    <span class="attr">android:hint</span>=<span class="string">"Please Select..."</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>SherlockSpinner有以下属性:<br><code>lineColor</code>: 设置底部横线的颜色<br>同时支持使用代码进行配置：mSherlockSpinner.setLineColor(0x00FF00);</p>
<blockquote>
<p>由于SherlockSpinner继承自<code>EditText</code>, 所以你可以使用EditText的其它属性，例如<code>gravity</code>、<code>textSize</code>、<code>textColor</code>…</p>
</blockquote>
<h3 id="2-2-还是像使用系统Spinner一样，在代码中设置Adapter和ItemClickListener"><a href="#2-2-还是像使用系统Spinner一样，在代码中设置Adapter和ItemClickListener" class="headerlink" title="2.2 还是像使用系统Spinner一样，在代码中设置Adapter和ItemClickListener:"></a>2.2 还是像使用系统Spinner一样，在代码中设置<code>Adapter</code>和<code>ItemClickListener</code>:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mSherlockSpinner = (SherlockSpinner) findViewById(R.id.sherlock_spinner);</span><br><span class="line">ArrayAdapter&lt;String&gt; mAdapterLanguages = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>, android.R.layout.simple_list_item_1, mLanguages);</span><br><span class="line">mSherlockSpinner.setAdapter(mAdapterLanguages);</span><br><span class="line">mSherlockSpinner.setOnItemClickListener(<span class="keyword">new</span> AdapterView.OnItemClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; parent, View view, <span class="keyword">int</span> position, <span class="keyword">long</span> id)</span> </span>&#123;</span><br><span class="line">        showMessage(<span class="string">"Select "</span> + mLanguages[position]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>以上，就可以像系统Spinner一样使用SherlockSpinner了，如果没有别的需求，这样也就够用了。如果你有点击请求网络数据，再异步显示下拉框的需求，可以看第3步的使用方法。</p>
<h3 id="2-3-可选-如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理"><a href="#2-3-可选-如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理" class="headerlink" title="2.3 (可选) 如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理"></a>2.3 (可选) 如果你想在异步加载数据后，再显示出更新后的数据，你可以使用它的点击事件来处理</h3><p><code>记住：</code>在获取数据后，你必须手动调用<code>sherlockSpinner.show()</code>方法来显示SherlockSpinner的下拉选项</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mSherlockSpinner.setOnClickListener(<span class="keyword">new</span> SherlockSpinner.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        getDataFromNet();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDataFromNet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// after delay 2s, modify the source data, to simulate net request</span></span><br><span class="line">    <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mLanguages[<span class="number">4</span>] = <span class="string">"Javaaaaaaaaaaa"</span>;</span><br><span class="line">            mAdapterLanguages.notifyDataSetChanged();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// then you must manually call sherlockSpinner.show()</span></span><br><span class="line">            runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    mSherlockSpinner.show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-更多属性"><a href="#3-更多属性" class="headerlink" title="3. 更多属性"></a>3. 更多属性</h2><ul>
<li>由于SherlockSpinner继承自EditText，所以你可以使用EditText的其它属性，例如<code>gravity</code>、<code>textSize</code>、<code>textColor</code>…</li>
<li>SherlockSpinner还有一个属性，可以设置下拉框的显示位置，即锚点设置：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mSherlockSpinner.setAnchorView(findViewById(R.id.llyt_anchor));</span><br></pre></td></tr></table></figure>
<p>效果如下图中4和5的区别，在第4部分中，下拉框停靠在Spinner上；而第5部分中，下拉框停靠在Spinner所在的整行布局上，宽度更大。</p>
<p><img src="http://7xlpfl.com1.z0.glb.clouddn.com/sherlockshi/2016-11-21-demo8.gif" alt=""></p>
<h1 id="四、其它"><a href="#四、其它" class="headerlink" title="四、其它"></a>四、其它</h1><p>另外，一个小小的Tip：<br>在styles.xml文件中配置以下代码，可使下拉框带上漂亮的分割线：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.DarkActionBar"</span>&gt;</span><span class="xml"></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:dropDownListViewStyle"</span>&gt;</span>@style/mySpinnerStyle<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"mySpinnerStyle"</span> <span class="attr">parent</span>=<span class="string">"android:Widget.ListView.DropDown"</span>&gt;</span><span class="xml"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:divider"</span>&gt;</span>#E0E0E0<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:dividerHeight"</span>&gt;</span>0.1dp<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>项目代码已共享到Github：<a href="https://github.com/SherlockShi/SherlockSpinner" target="_blank" rel="external">SherlockSpinner</a><br>欢迎fork、star、issue。</p>
<blockquote>
<p>PS：欢迎关注<a href="http://sherlockshi.github.io/">SherlockShi博客</a></p>
</blockquote>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" 
            data-thread-key="2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/" 
            data-url="http://sherlockshi.github.io/2016/11/21/15_Android/1540_Widget/自定义组合控件SherlockSpinner/"
            data-title="Android自定义组合控件：SherlockSpinner"></div>
    <!-- 多说评论框 end -->
</div>



            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    
        <a href="/2016/11/24/50_Java/使用BigDecimal对浮点数据进行精确计算/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/11/12/15_Android/1535_架构/Android MVP架构实践/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="SherlockShi's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        sherlock_shi@163.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="mailto:sherlock_shi@163.com" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/12/">十二月 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">十一月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">96</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">八月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">六月 2016<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">3</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	
		<li>
			<a href="/tags/" title="标签">
				标签
			</a>
		</li>
	
		<li>
			<a href="/links/" title="友情链接">
				友情链接
			</a>
		</li>
	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
             文章总数
             <span class="sidebar-badge">118</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">

    
    <!-- Paradox Footer Left Section -->
    <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/2283093752" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/sherlockshi" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


    <!--Copyright-->
    <div id="copyright">Copyright&nbsp;©&nbsp;
        <script type="text/javascript">var fd = new Date();
            document.write(fd.getFullYear());</script>
        &nbsp;SherlockShi's Home

        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <div>
            本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp
            你是第 <span id="busuanzi_value_site_uv"></span> 个来到的小伙伴
        </div>
    </div>

    <div>

    </div>

    <!-- Paradox Footer Right Section -->

    <!--
    I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
    It will not impact the appearance and can give developers a lot of support :)

    很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
    它不会影响美观并可以给开发者很大的支持。 :)
    -->

    <div class="mdl-mini-footer--right-section">
        <div>
            <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank"
                                                          class="footer-develop-a">Hexo</a></div>
            <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material"
                                                       target="_blank" class="footer-develop-a">Material</a></div>
        </div>
    </div>
    

</footer>
                
				<!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>




    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("H2W8h4AbtEwoE7j8i0AA9ABU-gzGzoHsz", "44qGllcHkSbi5usA2bihFiN1");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>



    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"sherlockshi"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->




<!-- Swiftye -->


<!-- Local Search-->

	<script>
	var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title' target='_blank'>"+ data_title;
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out characters
                            var start = first_occur - 6;
                            var end = first_occur + 6;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 10;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            })
                            str += "<p class=\"search-result\">" + match_content +"...</p>" +"</a>";
                        }
                    }
                })
                $resultContent.innerHTML = str;
            })
        }
    })
}
</script>

	<script>
        var inputArea = document.querySelector("#search");
        var getSearchFile = function(){
            var path = "search.xml";
            searchFunc(path, 'search', 'local-search-result');
        }

        inputArea.onfocus = function(){ getSearchFile() }
	</script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $(".post-toc-wrap").parent(".mdl-menu__container").css("position", "fixed");
    });
</script>

<!-- MathJax Load-->

            </main>
        </div>
		
    </body>
		
	
</html>
